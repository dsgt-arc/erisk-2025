{
  "type": "object",
  "description": "Schema for a single conversational turn, including input, output, agent reasoning, and internal assessment.",
  "properties": {
    "turn_number": {
      "type": "integer",
      "description": "Sequential number of the current conversational turn."
    },
    "input_message": {
      "type": "string",
      "description": "The message received by the agent in this turn (or 'start')."
    },
    "output_message": {
      "type": "string",
      "description": "The conversational response generated by the agent in this turn."
    },
    "next_step_reasoning": {
      "type": "string",
      "description": "Explicit reasoning for choosing this specific output_message. Explain how it connects to assessment goals (e.g., exploring a BDI domain, clarifying a previous point, building rapport) based on the current conversation context and assessment state."
    },
    "evaluation": {
      "type": "object",
      "description": "Internal assessment performed after the agent's turn, based on BDI criteria inferred from the conversation.",
      "properties": {
        "assessment_turn": {
          "type": "integer",
          "description": "The turn number corresponding to this assessment."
        },
        "assessment_state": {
          "type": "string",
          "description": "Current phase of the assessment process.",
          "enum": [
            "Initializing",
            "Gathering",
            "Consolidating",
            "Concluding",
            "Finalized"
          ]
        },
        "assessment_complete": {
          "type": "boolean",
          "description": "Flag indicating if the assessment process is considered finished."
        },
        "total_bdi_score": {
          "type": "integer",
          "description": "Sum of all 21 BDI item scores."
        },
        "classification_suggestion": {
          "type": "string",
          "description": "Suggested classification based on total BDI score pattern (Ranges approx: 0-10 Control/Normal, 11-16 Mild, 17-20 Borderline, 21-30 Moderate, 31-40 Severe, 41+ Extreme).",
          "enum": [
            "Control",
            "Mild",
            "Borderline",
            "Moderate",
            "Severe",
            "Extreme",
            "Uncertain"
          ]
        },
        "confidence": {
          "type": "number",
          "format": "float",
          "description": "Confidence level (0.0 to 1.0) in the classification suggestion.",
          "minimum": 0.0,
          "maximum": 1.0
        },
        "key_symptoms": {
          "type": "array",
          "description": "List of up to 4 most prominent symptom keywords based on high scores or significance.",
          "items": {
            "type": "string"
          },
          "maxItems": 4
        },
        "bdi_scores": {
          "type": "object",
          "description": "Individual scores (0-3) and reasons for each BDI item based on conversational inference.",
          "properties": {
            "q01_sadness": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q02_pessimism": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q03_past_failure": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q04_anhedonia": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q05_guilt": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q06_punishment": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q07_self_dislike": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q08_self_criticalness": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q09_suicidal_thoughts": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q10_crying": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q11_agitation": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q12_loss_of_interest_social": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q13_indecisiveness": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q14_worthlessness_appearance": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q15_loss_of_energy_work": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q16_sleep_changes": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q17_fatigue": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q18_appetite_changes": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q19_weight_loss": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q20_somatic_preoccupation": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            },
            "q21_loss_of_libido": {
              "type": "object",
              "properties": {
                "score": {
                  "type": "integer",
                  "description": "Score (0-3) based on severity/frequency inferred from conversation.",
                  "minimum": 0,
                  "maximum": 3
                },
                "reason": {
                  "type": "string",
                  "description": "Concise justification based on conversational evidence (<~60 words).",
                  "maxLength": 200
                }
              },
              "required": ["score", "reason"]
            }
          },
          "required": [
            "q01_sadness",
            "q02_pessimism",
            "q03_past_failure",
            "q04_anhedonia",
            "q05_guilt",
            "q06_punishment",
            "q07_self_dislike",
            "q08_self_criticalness",
            "q09_suicidal_thoughts",
            "q10_crying",
            "q11_agitation",
            "q12_loss_of_interest_social",
            "q13_indecisiveness",
            "q14_worthlessness_appearance",
            "q15_loss_of_energy_work",
            "q16_sleep_changes",
            "q17_fatigue",
            "q18_appetite_changes",
            "q19_weight_loss",
            "q20_somatic_preoccupation",
            "q21_loss_of_libido"
          ]
        }
      },
      "required": [
        "assessment_turn",
        "assessment_state",
        "assessment_complete",
        "total_bdi_score",
        "classification_suggestion",
        "confidence",
        "key_symptoms",
        "bdi_scores"
      ]
    }
  },
  "required": [
    "turn_number",
    "input_message",
    "output_message",
    "next_step_reasoning",
    "evaluation"
  ]
}
